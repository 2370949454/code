webpackJsonp([17],{HRB1:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r=e("Gu7T"),o=e.n(r),i=e("Xxa5"),a=e.n(i),n=e("exGp"),c=e.n(n),l=e("jovr"),u=e("GQaK"),v=e("gyMJ"),_={name:"search",computed:{showComputed:function(){return this.keywords.length>0&&this.input.length>0},showHotkey:function(){return!this.showResult},showResult:function(){return(this.searchBooks.length>0||"_id"in this.firstBook)&&this.input.length>0}},data:function(){return{staticHost:"http://statics.zhuishushenqi.com",searchBooks:[],firstIsCollect:!1,input:"",keywords:[],isLoading:!1,firstBook:{},start:0,total:0,loadMsg:"加载更多",pos:{x:0,y:0},preInput:"",dielog:!1,msg:null}},created:function(){var t=this;return c()(a.a.mark(function s(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},s,t)}))()},components:{Arrows:l.a},mounted:function(){var t=this;this.$nextTick(function(){t.scroll?t.scroll.refresh():(t.scroll=new u.a(t.$refs.wrapper,{pullUpLoad:{threshold:50},click:!0}),t.scroll.on("pullingUp",function(){t.getMore()}),t.scroll.on("scroll",function(s){t.pos=s}))})},methods:{linkTo:function(t){this.$router.push("/details/"+t)},collectBook:function(t){var s=this;Object(v.b)(t).then(function(t){s.firstIsCollect=!0,s.dielog=!0,s.msg="加入成功",setTimeout(function(){s.dielog=!1},1e3)})},keyComputed:function(t){var s=this;return c()(a.a.mark(function e(){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.target.value.trim())){e.next=6;break}return e.next=4,Object(v.j)(r).then(function(t){s.keywords=t.keywords||[]}).catch(function(t){s.keywords=[]});case 4:e.next=7;break;case 6:s.keywords=[];case 7:case"end":return e.stop()}},e,s)}))()},search:function(){var t=this;return c()(a.a.mark(function s(){var e;return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t.input!==t.preInput){s.next=2;break}return s.abrupt("return");case 2:return t.keywords=[],t.start=0,s.next=6,Object(v.t)({query:t.input,start:t.start,limit:10});case 6:e=s.sent,t.total=e.total||0,t.start=e.books.length||0,t.preInput=t.input,t.scroll&&t.scroll.scrollTo(0,0,200),t.firstBook=e.books.shift()||{},t.searchBooks=e.books||[],t.$nextTick(function(){t.scroll.refresh()});case 14:case"end":return s.stop()}},s,t)}))()},getMore:function(){var t=this;return c()(a.a.mark(function s(){var e,r;return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(t.start>t.total)){s.next=2;break}return s.abrupt("return",t.loadMsg="没有更多了");case 2:return t.loadMsg="加载中...",t.keywords=[],s.next=6,Object(v.t)({query:t.input,start:t.start,limit:10});case 6:r=s.sent,t.start+=10,(e=t.searchBooks).push.apply(e,o()(r.books)),t.scroll.finishPullUp(),t.$nextTick(function(){t.scroll.refresh()});case 11:case"end":return s.stop()}},s,t)}))()},keywordsSearch:function(t){var s=this;"LI"===t.target.tagName.toUpperCase()&&(this.input=t.target.innerText.trim(),this.$nextTick(function(){s.search()}))}},watch:{firstBook:{handler:function(t){var s=this;return c()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.p)(t._id);case 2:s.firstIsCollect=e.sent.includes;case 3:case"end":return e.stop()}},e,s)}))()},immediate:!0}}},p={render:function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("div",{staticClass:"my_Search"},[r("transition",{attrs:{name:"fade"}},[t.isLoading?r("Loading"):t._e()],1),t._v(" "),r("Tips",{attrs:{show:t.dielog,msg:t.msg}}),t._v(" "),r("section",{staticClass:"search-header"},[r("Arrows",{staticClass:"arrow"}),t._v(" "),r("div",{staticClass:"input-box"},[r("img",{staticClass:"search_pic",attrs:{src:e("bMVL"),alt:""}}),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],attrs:{type:"search",placeholder:"搜索作者、书籍、圈子、关键词"},domProps:{value:t.input},on:{input:[function(s){s.target.composing||(t.input=s.target.value)},t.keyComputed]}})]),t._v(" "),r("button",{attrs:{id:"search-btn",disabled:t.input.length<=0},on:{click:t.search}},[t._v("搜索\n    ")])],1),t._v(" "),r("section",{directives:[{name:"show",rawName:"v-show",value:t.showHotkey,expression:"showHotkey"}],staticClass:"search_content"},[r("h6",[t._v("热门搜索")]),t._v(" "),r("ul",{staticClass:"farm",on:{click:t.keywordsSearch}},[r("li",[t._v("永夜君王")]),t._v(" "),r("li",[t._v("修真聊天群")]),t._v(" "),r("li",[t._v("圣墟")]),t._v(" "),r("li",[t._v("帝霸")]),t._v(" "),r("li",[t._v("龙符")]),t._v(" "),r("li",[t._v("踏天无痕")]),t._v(" "),r("li",[t._v("最强狂兵")])])]),t._v(" "),r("section",{directives:[{name:"show",rawName:"v-show",value:t.showComputed,expression:"showComputed"}],staticClass:"search_computed"},[r("ul",{on:{click:t.keywordsSearch}},t._l(t.keywords,function(s,e){return r("li",{key:e},[t._v(t._s(s))])}))]),t._v(" "),r("section",{directives:[{name:"show",rawName:"v-show",value:t.showResult,expression:"showResult"}],ref:"wrapper",staticClass:"search_result"},[r("div",[r("div",["_id"in t.firstBook?r("div",{staticClass:"first-result"},[r("div",{staticClass:"zp_main",on:{click:function(s){t.linkTo(t.firstBook._id)}}},[r("div",{staticClass:"zp_pic"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.staticHost+t.firstBook.cover,expression:"staticHost + firstBook.cover"}]})]),t._v(" "),r("div",{staticClass:"zp_rb"},[r("i",{staticClass:"zp_name"},[t._v(t._s(t.firstBook.title))]),t._v(" "),r("p",[t._v(t._s(t.firstBook.author))]),t._v(" "),r("ul",{staticClass:"zp_list"},[r("li",[t._v(t._s(t.firstBook.cat)),r("span",[t._v("|")])]),t._v(" "),r("li",[t._v(t._s(t._f("countWan")(t.firstBook.wordCount))),r("span",[t._v("|")])]),t._v(" "),r("li",[t._v(t._s(t.firstBook.hasCp?"已完结":"连载中"))])])])]),t._v(" "),r("div",{staticClass:"zp_bottom"},[r("button",{staticClass:"left_btn",attrs:{disabled:t.firstIsCollect},on:{click:function(s){t.collectBook(t.firstBook._id)}}},[t._v("\n              "+t._s(t.firstIsCollect?"已加入":"加入书架")+"\n            ")]),t._v(" "),r("router-link",{attrs:{to:"/read/"+t.firstBook._id}},[r("button",{staticClass:"right_btn"},[t._v("立即阅读")])]),t._v(" "),r("router-view")],1)]):t._e(),t._v(" "),r("div",{staticClass:"listBox"},[r("h3",{staticClass:"zp_title"},[t._v("相关结果")]),t._v(" "),r("ul",{staticClass:"book-list"},[0===t.searchBooks.length?r("li",[t._v("\n              没有更多..\n            ")]):t._l(t.searchBooks,function(s,e){return r("router-link",{key:e,staticClass:"zp_content",attrs:{tag:"li",to:"/details/"+s._id}},[r("div",{staticClass:"pic-box"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.staticHost+s.cover,expression:"staticHost + book.cover"}]})]),t._v(" "),r("div",{staticClass:"zp_lump"},[r("h5",{staticClass:"zp_caption"},[t._v(t._s(s.title))]),t._v(" "),r("p",[t._v(t._s(s.shortIntro))]),t._v(" "),r("i",[t._v(t._s(s.author))]),t._v(" "),r("ul",{staticClass:"sort"},[r("li",[t._v(t._s(s.hasCp?"完结":"连载"))]),t._v(" "),r("li",[t._v(t._s(s.cat))]),t._v(" "),r("li",[t._v(t._s(t._f("countWan")(s.wordCount)))])])])])})],2)])]),t._v(" "),r("div",{staticClass:"pullup-wrapper"},[t._v(t._s(t.loadMsg))])])])],1)},staticRenderFns:[]};var h=e("VU/8")(_,p,!1,function(t){e("V+zI")},"data-v-2e184dbe",null);s.default=h.exports},"V+zI":function(t,s){}});
//# sourceMappingURL=17.dbbbacf13937d9b55464.js.map